CREATE database BEN;
use BEN;
SHOW TABLES;

CREATE TABLE REGIONS (
	REGION_ID INTEGER PRIMARY KEY,
    REGION_NAME VARCHAR(25)
);

CREATE TABLE COUNTRIES (
	COUNTRY_ID VARCHAR(2) PRIMARY KEY,
    COUNTRY_NAME VARCHAR(40),
    REGION_ID INTEGER,
    FOREIGN KEY (REGION_ID) REFERENCES REGIONS (REGION_ID)
);

CREATE TABLE LOCATIONS (
	LOCATION_ID INTEGER PRIMARY KEY,
    STREET_ADDRESS VARCHAR(25),
    POSTAL_CODE VARCHAR(12),
    CITY VARCHAR(30),
    STATE_PROVINCE VARCHAR(12),
    COUNTRY_ID VARCHAR(2),
    FOREIGN KEY (COUNTRY_ID) REFERENCES COUNTRIES (COUNTRY_ID)
);

CREATE TABLE DEPARTMENTS (
	DEPARTMENT_ID INTEGER PRIMARY KEY,
    DEPARTMENT_NAME VARCHAR(30),
    MANAGER_ID INTEGER,
    LOCATION_ID INTEGER,
    FOREIGN KEY (LOCATION_ID) REFERENCES LOCATIONS (LOCATION_ID)
);
DROP TABLE EMPLOYEES;
CREATE TABLE EMPLOYEES (
	EMPLOYEE_ID INTEGER,
    FIRST_NAME VARCHAR(20),
    LAST_NAME VARCHAR(25),
    EMAIL VARCHAR(25),
    PHONE_NUMBER VARCHAR(20),
    HIRE_DATE DATE,
    JOB_ID VARCHAR(10),
    SALARY INTEGER,
    COMMISSION_PCT INTEGER,
    MANAGER_ID INTEGER,
    DEPARTMENT_ID INTEGER,
    FOREIGN KEY (JOB_ID) REFERENCES JOBS (JOB_ID),
    FOREIGN KEY (DEPARTMENT_ID) REFERENCES DEPARTMENTS (DEPARTMENT_ID),
    FOREIGN KEY (EMPLOYEE_ID) REFERENCES JOB_HISTORY (EMPLOYEE_ID)
);

CREATE TABLE JOBS (
	JOB_ID VARCHAR(10) PRIMARY KEY,
    JOB_TITLE VARCHAR(35),
    MIN_SALARY INTEGER,
    MAX_SALARY INTEGER
);
drop table JOB_HISTORY;
CREATE TABLE JOB_HISTORY (
	EMPLOYEE_ID INTEGER,
    START_DATE DATE,
    END_DATE DATE,
    JOB_ID VARCHAR(10),
    DEPARTMENT_ID INTEGER,
    PRIMARY KEY (EMPLOYEE_ID, START_DATE),
    FOREIGN KEY (JOB_ID) REFERENCES JOBS (JOB_ID),
    FOREIGN KEY (DEPARTMENT_ID) REFERENCES DEPARTMENTS (DEPARTMENT_ID)
);
drop table job_grades;
CREATE TABLE JOB_GRADES (
	GRADE_LEVEL VARCHAR(2) PRIMARY KEY,
    LOWEST_SAL INTEGER,
    HIGHEST_SAL INTEGER
);

INSERT INTO REGIONS VALUES (1, 'EUROPE');
INSERT INTO REGIONS VALUES (2, 'Asia & Pacific');
INSERT INTO REGIONS VALUES (3, 'North America');
INSERT INTO COUNTRIES VALUES ('DE', 'Germany', 1);
INSERT INTO COUNTRIES VALUES ('IT', 'Italy', 1);
INSERT INTO COUNTRIES VALUES ('JP', 'Japan', 3);
INSERT INTO COUNTRIES VALUES ('US', 'United State', 2);
INSERT INTO LOCATIONS VALUES (1000, '1297 Via Cola di Rie', 989, 'Roma', null, 'IT');
INSERT INTO LOCATIONS VALUES (1100, '93091 Calle della Te', 10934, 'Venice', null, 'IT');
INSERT INTO LOCATIONS VALUES (1200, '2017 Shinjuku-ku', 1689, 'Tokyo', 'Tokyo Prefec', 'JP');
INSERT INTO LOCATIONS VALUES (1400, '2014 Jabberwocky Rd', 26192, 'Southlake', 'Texas', 'US');
INSERT INTO DEPARTMENTS VALUES (10, 'Administration', 200, 1100);
INSERT INTO DEPARTMENTS VALUES (20, 'Marketing', 201, 1200);
INSERT INTO DEPARTMENTS VALUES (30, 'Purchasing', 202, 1400);
INSERT INTO JOBS VALUES ('MK_REP', 'AAA', 100, 1000);
INSERT INTO JOBS VALUES ('ST_CLERK', 'BBB', 100, 1000);
INSERT INTO JOBS VALUES ('IT_PROG', 'CCC', 100, 1000);
INSERT INTO JOB_HISTORY VALUES (102, '1993-01-13', '1998-07-24', 'IT_PROG', 20);
INSERT INTO JOB_HISTORY VALUES (101, '1989-09-21', '1993-10-27', 'MK_REP', 10);
INSERT INTO JOB_HISTORY VALUES (101, '1993-10-28', '1997-03-15', 'MK_REP', 30);
INSERT INTO JOB_HISTORY VALUES (100, '1996-02-17', '1999-12-19', 'ST_CLERK', 30);
INSERT INTO JOB_HISTORY VALUES (103, '1998-03-24', '1999-12-31', 'MK_REP', 20);
INSERT INTO EMPLOYEES VALUES (100, 'Steven', 'King', 'SKING', '515-1234567', '1987-06-17', 'ST_CLERK', 24000.00, 0.00, 109, 10);
INSERT INTO EMPLOYEES VALUES (101, 'Neena', 'Kochhar', 'NKOCHHAR', '515-1234568', '1987-06-18', 'MK_REP', 17000.00, 0.00, 103, 20);
INSERT INTO EMPLOYEES VALUES (102, 'Lex', 'De Haan', 'LDEHAAN', '515-1234569', '1987-06-19', 'IT_PROG', 17000.00, 0.00, 108, 30);
INSERT INTO EMPLOYEES VALUES (103, 'Alexander', 'Hunold', 'AHUNOLD', '590-4234567', '1987-06-20', 'MK_REP', 9000.00, 0.00, 105, 20);
SELECT * FROM REGIONS;
SELECT * FROM COUNTRIES;
SELECT * FROM LOCATIONS;
SELECT * FROM DEPARTMENTS;
SELECT * FROM JOBS;
SELECT * FROM JOB_HISTORY;
SELECT * FROM EMPLOYEES;
SELECT * FROM JOB_GRADES;

-- 3
SELECT LOCATION_ID, STREET_ADDRESS, CITY, STATE_PROVINCE, COUNTRY_NAME
FROM LOCATIONS, COUNTRIES
WHERE LOCATIONS.COUNTRY_ID = COUNTRIES.COUNTRY_ID
;

-- 4
SELECT FIRST_NAME, LAST_NAME, DEPARTMENT_ID FROM EMPLOYEES;

-- 5
SELECT FIRST_NAME, LAST_NAME, JOB_ID, DEPARTMENT_ID 
FROM EMPLOYEES E, JOB_HISTORY J, DEPARTMENTS D, LOCATIONS L, COUNTRIES C
WHERE EMPLOYEES.EMPLOYEE_ID = JOB_HISTORY.EMPLOYEE_ID
AND JOB_HISTORY.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID
AND DEPARTMENTS.LOCATION_ID = LOCATIONS.LOCATION_ID
AND LOCATIONS.COUNTRY_ID = COUNTRIES.COUNTRY_ID
-- AND COUNTRY_NAME = 'Japan'
; -- BUG

-- 6
-- 7
-- 8
-- 9
-- 10
-- 11
-- 12

